plugins {

    id 'application'
    id 'org.flywaydb.flyway' version '9.18.0'
}

repositories {

    mavenLocal()
    mavenCentral()
}

sourceCompatibility = '17'
[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

dependencies {

    implementation 'com.h2database:h2:2.1.214'

    annotationProcessor 'org.projectlombok:lombok:1.18.26'
    compileOnly 'org.projectlombok:lombok:1.18.26'

    implementation 'org.hibernate:hibernate-core:6.2.2.Final'
    implementation 'org.flywaydb:flyway-core:9.18.0'

    testImplementation 'org.junit.jupiter:junit-jupiter:5.9.1'
    testImplementation 'org.mockito:mockito-junit-jupiter:5.2.0'

    testImplementation 'org.apache.logging.log4j:log4j-core:2.20.0'
    testImplementation 'org.apache.logging.log4j:log4j-api:2.20.0'
    testImplementation 'org.apache.logging.log4j:log4j-1.2-api:2.19.0'
}

application {

    mainClass = 'com.goit.fry.hibernate.FlywayMigration'
}

flyway {

    url = "jdbc:h2:file:$rootDir/spacetravel"
    user = "sa"
    baselineOnMigrate = true
    locations = ["filesystem:$rootDir/src/main/resources/migration"]
    cleanDisabled = false
}

tasks.named('test') {

    useJUnitPlatform()
}